import { Link } from '@brillout/docpress'
import { UiFrameworkExtension } from '../../components'
import { TableStyle } from './TableStyle'

You can add `<head>` tags with following settings.

<TableStyle>
Setting | Sets
-- | --
<Link href="/title">`title`</Link> | <ul><li>[`<title>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/title)</li> <li>[`<meta property="og:title">`](https://ogp.me/#metadata:~:text=every%20page%20are%3A-,og%3Atitle,-%2D%20The%20title%20of)</li></ul>
<Link href="/description">`description`</Link> | <ul><li>[`<meta name="description">`](https://moz.com/learn/seo/meta-description)</li> <li>[`<meta property="og:description">`](https://ogp.me/#optional:~:text=accompany%20this%20object.-,og%3Adescription,-%2D%20A%20one%20to)</li></ul>
<Link href="/image">`image`</Link> | <ul> <li>[`<meta property="og:image">`](https://ahrefs.com/blog/open-graph-meta-tags/) (preview image)</li> <li>[`<meta name="twitter:card" content="summary_large_image">`](https://ogp.me/#optional:~:text=accompany%20this%20object.-,og%3Adescription,-%2D%20A%20one%20to)</li></ul>
<Link href="/viewport">`viewport`</Link> | <ul><li>[`<meta name="viewport">`](https://developer.mozilla.org/en-US/docs/Web/HTML/Viewport_meta_tag)</li></ul>
<Link href="/Head-setting">`Head`</Link> | Other `<head>` tags such as: <ul> <li>[`<link rel="icon">`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link) (favicon)</li> <li>[`<link rel="apple-touch-icon">`](https://stackoverflow.com/questions/20440512/why-use-link-rel-apple-touch-icon-image-src/20440627#20440627) (mobile icon)</li> <li>[`<script>`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script)</li> <li>...</li> </ul>
</TableStyle>

> You can dynamically set these settings inside your `+data` hook, by using the <Link href="/useConfig">`useConfig()` hook</Link>.

> You can dynamically set these settings inside your components, by using the <Link href="/useConfig#config-head">`<Head>` component</Link>.
> ```jsx
> import { Config } from 'vike-react/Config' // or vike-vue / vike-solid
> import { Head } from 'vike-react/Head'
> import { useAsync } from 'react-streaming'
>
> function Movies() {
>   const movies = useAsync(() => fetch('https://star-wars.brillout.com/api/films.json'))
>   return (
>     <Config title={`${moviesData.length} Star Wars Movies`} />
>     <Head>
>       <meta name="description" content={`List of all ${movies.length} Star Wars movies.`} />
>     <Head>
>     <ul>{ movies.map(movie => <li>{movie.title}</li>) }</ul>
>   )
> }
> ```

> See also `htmlAttributes` and `bodyAttributes` to add attributes such as `<html class="dark">` or `<body class="dark">`.

> You can create <Link href="#custom-settings">custom settings</Link>.

> These settings are provided by <UiFrameworkExtension name />. If you don't use <UiFrameworkExtension name /> then instead see <Link href="/head-manual" />.


## Typical usage

Let's see how you typically use these settings.

### Defaults

```js
// pages/+config.js

import image from './previewImage.jpg'

// Sets defaults, which some pages will override
export default {
  // Default <title>
  title: 'Awesome Rockets',
  // Default <meta name="description">
  description: 'We deliver payload to space',
  // Default <meta property="og:image">
  image
}
```

### Globals

```jsx
// /pages/+Head.jsx or
// /pages/+Head.vue

import favicon from './favicon.svg'

// Applies to all pages (cannot be overriden)
export function Head() {
  return <>
    <link rel="icon" href={favicon} type="image/svg+xml">
  </>
}
```

> Unlike the other settings, the `Head` setting is cumulative which means that `pages/+Head.js` applies to all your pages and cannot be overriden. See <Link href="/Head-setting#cumulative"></Link>.


### Page-specific

You can overriding the defaults and set different `<head>` tags for different pages.


### Using data

Setting `<head>` tags based on <Link href="/data-fetching">fetched data</Link>:

```js
// /pages/rocket/starship/+data.js
// Environment: server

export async function data() {
  const rocket = await sql.run(
    'SELECT { title, description } FROM rockets WHERE name = "starship";'
  )
  return rocket
}
```
```ts
// pages/product/+title.ts
// Environment: server, client

import type { PageContext } from 'vike/types'

// Overrides the default <title>
export default (pageContext) => pageContext.data.rocket.name
```

```ts
// pages/product/+description.ts
// Environment: server, client

import type { PageContext } from 'vike/types'

// Overrides the default <meta name="description">
export default (pageContext) => pageContext.data.rocket.description
```

> You can dynamically set these settings inside your `+data` hook, by using the
> You can dynamically set these settings inside your components, by using the

You can also use:
- <Link href="/useData">`useData()`</Link> and <Link href="/usePageContext">`usePageContext()`</Link> inside the `+Head` setting, see <Link href="/Head-setting#using-data" />.
- <Link href="/useConfig">The `useConfig()` hook</Link> to set `<head>` tags directly inside your `+data` hook (or any Vike hook).
- <Link href="/useConfig#config-head">The `<Config>` and `<Head>` components</Link> to set `<head>` tags directly inside your components.
  > The `<Config>` and `<Head>` components are particularly relevant when using integrations that enable components to fetch data, such as [`vike-react-query`](https://github.com/vikejs/vike-react/tree/main/packages/vike-react-query#readme) and [`vike-react-apollo`](https://github.com/vikejs/vike-react/tree/main/packages/vike-react-apollo#readme).


## `Head`

Setting `<head>` tags only to one page and based on <Link href="/data-fetching">fetched data</Link>:

```js
// /pages/rocket/starship/+data.js
// Environment: server

export { data }

async function data() {
  const rocket = await sql.run(
    'SELECT { title, description, social_image } FROM rockets WHERE name = "starship";'
  )
  return rocket
}
```
```jsx
// /pages/rocket/starship/+Head.jsx
// Environment: server

export { Head }

import { useData } from 'vike-react/useData' // or vike-vue / vike-solid

function Head() {
  const rocket = useData()
  return <>
    <meta name="description" content={rocket.description}>
    <meta property="og:image" content={rocket.social_image}>
  </>
}
```


## `title` & `favicon`

If your pages can have different `<title>` values, then use the setting `title` instead of the <Link href="#head">`Head`</Link> setting:

```js
// /pages/rocket/starship/+title.js
// Environment: server, client
export const title = 'SpaceX | Rocket Starship'
```
```js
// /pages/rocket/falcon-9/+title.js
// Environment: server, client
export const title = 'SpaceX | Rocket Falcon 9'
```

Upon <Link href="/client-routing">client-side navigating</Link> from the URL `/rocket/starship` to `/rocket/falcon-9`, the page's title is dynamically updated from `SpaceX | Rocket Starship` to `SpaceX | Rocket Falcon 9`. (By mutating the DOM with [`document.title = 'SpaceX | Rocket Falcon 9'`](https://developer.mozilla.org/en-US/docs/Web/API/Document/title).)

While defining `<title>` by using the `Head` setting correctly sets the page's title for the first page the user visits, it doesn't update the page's title upon <Link href="/client-routing">client-side navigation</Link>.

> Most `<head>` tags, such as [the social image tag `<meta property="og:image">`](https://ogp.me/), don't need to be updated upon client-side navigation because they are only used by crawlers. (Browsers don't do anything with `<meta property="og:image">`.) Crawlers don't execute JavaScript and, therefore, don't client-side navigate.

Likewise, if your [favicon](https://developer.mozilla.org/en-US/docs/Learn/HTML/Introduction_to_HTML/The_head_metadata_in_HTML#adding_custom_icons_to_your_site) can change from page to page, then define `/pages/rocket/starship/+favicon.png` instead of using the `Head` setting.

You can set `title` and `favicon` based on <Link href="/data-fetching">fetched data</Link>, for example:

```js
// /pages/rocket/starship/+title.js
// Environment: server, client

export function title(pageContext) {
  const rocket = pageContext.data
  return rocket.title
}
```
```tsx
// With TypeScript:

import type { Data } from './+data'
import type { PageContext } from 'vike/types'
export function title(pageContext: PageContext<Data>) {
  const rocket = pageContext.data
  return rocket.title
}
```
> As shown [here](https://gist.github.com/brillout/e7fe603bd44c9ec1be7e98f3ae28636a) you can define the logic, of using `data.title` to set the page's title, once and apply it to all your pages.


## Custom settings

TODO


## Internationalization

Example of internationalizing (i18n) `<head>` tags:

```jsx
// /pages/+Head.js
// Environment: server

export { Head }

import { usePageContext } from 'vike-react/usePageContext' // or 'vike-vue' / 'vike-solid'

function Head() {
  const pageContext = usePageContext()
  const description = pageContext.locale === 'de-DE' ?
    'Wir liefern zum Weltall.' :
    'We deliver payload to space.'
  return <>
    <meta name="description" content={description}>
  </>
}
```
```js
// /pages/+title.js
// Environment: server, client

export function title(pageContext) {
  const title = pageContext.locale === 'de-DE' ?
    'SpaceX | Das Weltall Unternehmen' :
    'SpaceX | The space company'
  return title
}
```

See also:
 - <Link href="/i18n" />
 - <Link href="/usePageContext" />


## See also

- <Link href="/Head-setting" />
- <Link href="/markdown#metadata" />
- <Link href="/data-fetching" />
- <Link href="/lang" />
- <Link href="/usePageContext" />
- <Link href="/useData" />
- <Link href="/pageContext" />
- [Blog post "My current HTML boilerplate" showcasing and explaing a common boilerplate](https://www.matuzo.at/blog/html-boilerplate/)
